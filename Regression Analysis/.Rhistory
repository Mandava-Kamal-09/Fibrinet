which(abs(cor(lysis_trans[,1:9]))>0.5) # This step ensured that no strong correlation is present in the transformed data which is a positive sign, the output values we got are the values along the diagonals
#Model Fitting
lysis_lm <- lm(medianlysis ~., data = lysis_trans)
summary(lysis_lm)
boxcox(lysis_lm)
lysis_trans$medianlysis <- 1/(lysis_trans$medianlysis) # this would push the log values of medianlysis to medianlysis variable - the name remains unchanged but the transformation happens
# refitting the model with transformed data
trans_lysis_lm <- lm(medianlysis ~., data = lysis_trans)
summary(trans_lysis_lm)
# Checking for multi-collinearity
vif(trans_lysis_lm) # No multi-collinearity present all are less than 10 (cut-off)
fwd <- lm(medianlysis ~ 1, data = lysis_trans)
out_fwd <- step(fwd, scope = ~ Snap.Proportion + ktPAon_log + kplioff_log + kplgon_log + KdtPAyesplg_log + KdtPAnoplg_log +KdPLGnicked_log+ KdPLGintact_log+kdeg_kncat_log , direction = "forward")
summary(out_fwd)
subset_model <- regsubsets(medianlysis ~ kdeg_kncat_log + kplioff_log +
Snap.Proportion + ktPAon_log + KdtPAnoplg_log +
KdtPAyesplg_log + kplgon_log + KdPLGnicked_log +
KdPLGintact_log,
data = lysis_trans)
summary(subset_model)$outmat
names(summary(subset_model))
which.min(summary(subset_model)$bic) # gives 1 variable model; which means 1 variable model is best according to bic
which.max(summary(subset_model)$adjr2) # gives 5 variable model; which means 5 variable model is best accroding to Adjusted R squared
plot(subset_model, scale = "adjr2")
best_model <- lm(medianlysis ~ kdeg_kncat_log + kplioff_log +Snap.Proportion + ktPAon_log + KdtPAnoplg_log + kplgon_log, data = lysis_trans)
summary(best_model)
# Constant variance check
plot(best_model, 1)
# Normality check
plot(best_model, 2)
#Outlier check
rstd <- rstandard(best_model)
which(abs(rstd)>3)
# High Leverage
h <- hatvalues(best_model)
# cut-off value would be: (2(k+1))/n = (2*(5+1))/42 = 12/42 = 0.2857143
which(h > 0.2857143)
# influential Observations
ckd <- cooks.distance(best_model)
which(ckd > 0.5)
which(ckd > 1)
plot(best_model, 5)
library(car)
library(MASS)
library(leaps)
library(psych)
library(corrplot)
lysis <- read.csv("target.csv")
summary(lysis)
sapply(lysis, sd)
describe(lysis)
pairs(lysis[, c("medianlysis", "Snap.Proportion", "ktPAon", "kplioff", "kplgon", "KdtPAyesplg", "KdtPAnoplg", "KdPLGnicked", "KdPLGintact", "kdeg.and.kncat")], lower.panel=NULL)
Org_model <- lm(medianlysis ~., data = lysis)
summary(Org_model)
cor(lysis)
corrplot(cor(lysis), method = "color", t1.cex=0.7)
par(mfrow=c(3,3))
for(i in 1:9) hist(lysis[[i]], main=names(lysis)[i])
hist(lysis$medianlysis, main="medianlysis")
# Snap.Proportion is a proportion (0–1), not a rate constant or concentration. It may already be bounded and less skewed, or have a different distribution, so log transformation is unnecessary.
lysis$ktPAon_log <- log(lysis$ktPAon)
lysis$kplioff_log <- log(lysis$kplioff)
lysis$kplgon_log <- log(lysis$kplgon)
lysis$KdtPAyesplg_log <- log(lysis$KdtPAyesplg)
lysis$KdtPAnoplg_log <- log(lysis$KdtPAnoplg)
lysis$KdPLGnicked_log <- log(lysis$KdPLGnicked)
lysis$KdPLGintact_log <- log(lysis$KdPLGintact)
lysis$kdeg_kncat_log <- log(lysis$kdeg.and.kncat)
# Keep transformed predictors + original Snap.Proportion
lysis_trans <- data.frame(
Snap.Proportion = lysis$Snap.Proportion,
ktPAon_log = lysis$ktPAon_log,
kplioff_log = lysis$kplioff_log,
kplgon_log = lysis$kplgon_log,
KdtPAyesplg_log = lysis$KdtPAyesplg_log,
KdtPAnoplg_log = lysis$KdtPAnoplg_log,
KdPLGnicked_log = lysis$KdPLGnicked_log,
KdPLGintact_log = lysis$KdPLGintact_log,
kdeg_kncat_log = lysis$kdeg_kncat_log,
medianlysis = lysis$medianlysis
)
# Quick check
summary(lysis_trans)
par(mfrow=c(3,3))
for(i in 1:9) hist(lysis_trans[[i]], main=names(lysis_trans)[i])
#Model Fitting
lysis_lm <- lm(medianlysis ~., data = lysis_trans)
summary(lysis_lm)
boxcox(lysis_lm)
lysis_trans$medianlysis <- 1/(lysis_trans$medianlysis) # this would push the inverse of medianlysis to medianlysis variable - the name remains unchanged but the transformation happens
# refitting the model with transformed data
trans_lysis_lm <- lm(medianlysis ~., data = lysis_trans)
summary(trans_lysis_lm)
# Checking for multi-collinearity
vif(trans_lysis_lm) # No multi-collinearity present all are less than 10 (cut-off)
fwd <- lm(medianlysis ~ 1, data = lysis_trans)
out_fwd <- step(fwd, scope = ~ Snap.Proportion + ktPAon_log + kplioff_log + kplgon_log + KdtPAyesplg_log + KdtPAnoplg_log +KdPLGnicked_log+ KdPLGintact_log+kdeg_kncat_log , direction = "forward")
summary(out_fwd)
subset_model <- regsubsets(medianlysis ~ kdeg_kncat_log + kplioff_log +
Snap.Proportion + ktPAon_log + KdtPAnoplg_log +
KdtPAyesplg_log + kplgon_log + KdPLGnicked_log +
KdPLGintact_log,
data = lysis_trans)
summary(subset_model)$outmat
names(summary(subset_model))
which.min(summary(subset_model)$bic)
which.max(summary(subset_model)$adjr2)
plot(subset_model, scale = "adjr2")
best_model <- lm(medianlysis ~ kdeg_kncat_log + kplioff_log +Snap.Proportion + ktPAon_log + KdtPAnoplg_log + kplgon_log, data = lysis_trans)
summary(best_model)
# Constant variance check
plot(best_model, 1)
# Normality check
plot(best_model, 2)
#Outlier check
rstd <- rstandard(best_model)
which(abs(rstd)>3)
# High Leverage
h <- hatvalues(best_model)
# cut-off value would be: (2(k+1))/n = (2*(6+1))/42 = 14/42 = 0.3333
which(h > 0.3333)
# influential Observations
ckd <- cooks.distance(best_model)
which(ckd > 0.5)
which(ckd > 1)
plot(best_model, 5)
new_data <- data.frame(
kdeg_kncat_log = -0.6931,        # Example: log-transformed value (e.g., log(0.5) = -0.6931)
kplioff_log = -1.2039,           # Example: log-transformed value (e.g., log(0.3) = -1.2039)
Snap.Proportion = 0.25,          # Original value (not log-transformed, between 0-1)
ktPAon_log = -0.9163,            # Example: log-transformed value (e.g., log(0.4) = -0.9163)
KdtPAnoplg_log = -1.6094,        # Example: log-transformed value (e.g., log(0.2) = -1.6094)
kplgon_log = -1.0498             # Example: log-transformed value (e.g., log(0.35) = -1.0498)
)
predicted_reciprocal <- predict(best_model, newdata = new_data)
predicted_reciprocal
predicted_medianlysis <- 1 / predicted_reciprocal
predicted_medianlysis
new_data <- data.frame(
kdeg_kncat_log = log(0.5),        # Example: log-transformed value (e.g., log(0.5) = -0.6931)
kplioff_log = log(57.6),           # Example: log-transformed value (e.g., log(0.3) = -1.2039)
Snap.Proportion = log(0.6667),          # Original value (not log-transformed, between 0-1)
ktPAon_log = log(0.1),            # Example: log-transformed value (e.g., log(0.4) = -0.9163)
KdtPAnoplg_log = log(0.36),        # Example: log-transformed value (e.g., log(0.2) = -1.6094)
kplgon_log = log(0.1)             # Example: log-transformed value (e.g., log(0.35) = -1.0498)
)
predicted_reciprocal <- predict(best_model, newdata = new_data)
predicted_medianlysis <- 1 / predicted_reciprocal
predicted_medianlysis
new_data <- data.frame(
kdeg_kncat_log = 0.5,        # Example: log-transformed value (e.g., log(0.5) = -0.6931)
kplioff_log = 57.6,           # Example: log-transformed value (e.g., log(0.3) = -1.2039)
Snap.Proportion = 0.6667,          # Original value (not log-transformed, between 0-1)
ktPAon_log = 0.1,            # Example: log-transformed value (e.g., log(0.4) = -0.9163)
KdtPAnoplg_log = 0.36,        # Example: log-transformed value (e.g., log(0.2) = -1.6094)
kplgon_log = 0.1            # Example: log-transformed value (e.g., log(0.35) = -1.0498)
)
predicted_reciprocal <- predict(best_model, newdata = new_data)
predicted_reciprocal
# Read the data
lysis <- read.csv("target.csv")
# Get the 36th observation (row 37 since header is row 1)
obs_36 <- lysis[36, ]
# Display the actual values
cat("36th Observation Values:\n")
cat("Snap.Proportion:", obs_36$Snap.Proportion, "\n")
cat("ktPAon:", obs_36$ktPAon, "\n")
cat("kplioff:", obs_36$kplioff, "\n")
cat("kplgon:", obs_36$kplgon, "\n")
cat("KdtPAnoplg:", obs_36$KdtPAnoplg, "\n")
cat("kdeg.and.kncat:", obs_36$kdeg.and.kncat, "\n")
cat("Actual medianlysis:", obs_36$medianlysis, "\n\n")
# Prepare data for prediction (log-transform where needed)
new_data <- data.frame(
kdeg_kncat_log = log(obs_36$kdeg.and.kncat),
kplioff_log = log(obs_36$kplioff),
Snap.Proportion = obs_36$Snap.Proportion,
ktPAon_log = log(obs_36$ktPAon),
KdtPAnoplg_log = log(obs_36$KdtPAnoplg),
kplgon_log = log(obs_36$kplgon)
)
# Display transformed values
cat("Transformed values for prediction:\n")
print(new_data)
cat("\n")
# Predict using best_model (returns 1/medianlysis)
predicted_reciprocal <- predict(best_model, newdata = new_data)
# Transform back to get medianlysis
predicted_medianlysis <- 1 / predicted_reciprocal
# Compare results
cat("=", rep("=", 50), "\n")
cat("PREDICTION RESULTS:\n")
cat("=", rep("=", 50), "\n")
cat("Actual medianlysis:    ", obs_36$medianlysis, "\n")
cat("Predicted medianlysis: ", predicted_medianlysis, "\n")
cat("Difference:            ", abs(obs_36$medianlysis - predicted_medianlysis), "\n")
cat("Percent Error:         ", abs(obs_36$medianlysis - predicted_medianlysis) / obs_36$medianlysis * 100, "%\n")
cat("=", rep("=", 50), "\n")
new_data <- data.frame(
kdeg_kncat_log = log(0.5),        # Example: log-transformed value (e.g., log(0.5) = -0.6931)
kplioff_log = log(57.6),           # Example: log-transformed value (e.g., log(0.3) = -1.2039)
Snap.Proportion = log(0.6667),          # Original value (not log-transformed, between 0-1)
ktPAon_log = log(0.1),            # Example: log-transformed value (e.g., log(0.4) = -0.9163)
KdtPAnoplg_log = log(0.36),        # Example: log-transformed value (e.g., log(0.2) = -1.6094)
kplgon_log = log(0.1)             # Example: log-transformed value (e.g., log(0.35) = -1.0498)
)
predicted_reciprocal <- predict(best_model, newdata = new_data)
predicted_medianlysis <- 1 / predicted_reciprocal
predicted_medianlysis
new_data <- data.frame(
kdeg_kncat_log = log(0.5),        # Example: log-transformed value (e.g., log(0.5) = -0.6931)
kplioff_log = log(57.6),           # Example: log-transformed value (e.g., log(0.3) = -1.2039)
Snap.Proportion = log(0.6667),          # Original value (not log-transformed, between 0-1)
ktPAon_log = log(0.1),            # Example: log-transformed value (e.g., log(0.4) = -0.9163)
KdtPAnoplg_log = log(0.36),        # Example: log-transformed value (e.g., log(0.2) = -1.6094)
kplgon_log = log(0.1)             # Example: log-transformed value (e.g., log(0.35) = -1.0498)
)
predicted_reciprocal <- predict(best_model, newdata = new_data)
predicted_medianlysis <- 1 / predicted_reciprocal
predicted_medianlysis
new_data <- data.frame(
kdeg_kncat_log = log(0.5),        # Example: log-transformed value (e.g., log(0.5) = -0.6931)
kplioff_log = log(57.6),           # Example: log-transformed value (e.g., log(0.3) = -1.2039)
Snap.Proportion = log(0.6667),          # Original value (not log-transformed, between 0-1)
ktPAon_log = log(0.1),            # Example: log-transformed value (e.g., log(0.4) = -0.9163)
KdtPAnoplg_log = log(0.36),        # Example: log-transformed value (e.g., log(0.2) = -1.6094)
kplgon_log = log(0.1)             # Example: log-transformed value (e.g., log(0.35) = -1.0498)
)
predicted_reciprocal <- predict(best_model, newdata = new_data)
predicted_medianlysis <- 1 / predicted_reciprocal
predicted_medianlysis
new_data <- data.frame(
kdeg_kncat_log = log(0.5),        # Example: log-transformed value (e.g., log(0.5) = -0.6931)
kplioff_log = log(57.6),           # Example: log-transformed value (e.g., log(0.3) = -1.2039)
Snap.Proportion = log(0.6667),          # Original value (not log-transformed, between 0-1)
ktPAon_log = log(0.1),            # Example: log-transformed value (e.g., log(0.4) = -0.9163)
KdtPAnoplg_log = log(0.36),        # Example: log-transformed value (e.g., log(0.2) = -1.6094)
kplgon_log = log(0.1)             # Example: log-transformed value (e.g., log(0.35) = -1.0498)
)
predicted_reciprocal <- predict(best_model, newdata = new_data)
predicted_medianlysis <- 1 / predicted_reciprocal
predicted_medianlysis
new_data <- data.frame(
kdeg_kncat_log = log(0.5),        # Example: log-transformed value (e.g., log(0.5) = -0.6931)
kplioff_log = log(57.6),           # Example: log-transformed value (e.g., log(0.3) = -1.2039)
Snap.Proportion = log(0.6667),          # Original value (not log-transformed, between 0-1)
ktPAon_log = log(0.1),            # Example: log-transformed value (e.g., log(0.4) = -0.9163)
KdtPAnoplg_log = log(0.36),        # Example: log-transformed value (e.g., log(0.2) = -1.6094)
kplgon_log = log(0.1)             # Example: log-transformed value (e.g., log(0.35) = -1.0498)
)
predicted_reciprocal <- predict(best_model, newdata = new_data)
predicted_medianlysis <- 1 / predicted_reciprocal
predicted_medianlysis
# Read the data
lysis <- read.csv("target.csv")
# Get the 36th observation (row 37 since header is row 1)
obs_36 <- lysis[36, ]
# Display the actual values
cat("36th Observation Values:\n")
cat("Snap.Proportion:", obs_36$Snap.Proportion, "\n")
cat("ktPAon:", obs_36$ktPAon, "\n")
cat("kplioff:", obs_36$kplioff, "\n")
cat("kplgon:", obs_36$kplgon, "\n")
cat("KdtPAnoplg:", obs_36$KdtPAnoplg, "\n")
cat("kdeg.and.kncat:", obs_36$kdeg.and.kncat, "\n")
cat("Actual medianlysis:", obs_36$medianlysis, "\n\n")
# Prepare data for prediction (log-transform where needed)
new_data <- data.frame(
kdeg_kncat_log = log(obs_36$kdeg.and.kncat),
kplioff_log = log(obs_36$kplioff),
Snap.Proportion = obs_36$Snap.Proportion,
ktPAon_log = log(obs_36$ktPAon),
KdtPAnoplg_log = log(obs_36$KdtPAnoplg),
kplgon_log = log(obs_36$kplgon)
)
# Display transformed values
cat("Transformed values for prediction:\n")
print(new_data)
cat("\n")
# Predict using best_model (returns 1/medianlysis)
predicted_reciprocal <- predict(best_model, newdata = new_data)
# Transform back to get medianlysis
predicted_medianlysis <- 1 / predicted_reciprocal
# Compare results
cat("=", rep("=", 50), "\n")
cat("PREDICTION RESULTS:\n")
cat("=", rep("=", 50), "\n")
cat("Actual medianlysis:    ", obs_36$medianlysis, "\n")
cat("Predicted medianlysis: ", predicted_medianlysis, "\n")
cat("Difference:            ", abs(obs_36$medianlysis - predicted_medianlysis), "\n")
cat("Percent Error:         ", abs(obs_36$medianlysis - predicted_medianlysis) / obs_36$medianlysis * 100, "%\n")
cat("=", rep("=", 50), "\n")
# Check prediction for observation 36
obs_36 <- lysis[36, ]
new_data <- data.frame(
kdeg_kncat_log = log(obs_36$kdeg.and.kncat),
kplioff_log = log(obs_36$kplioff),
Snap.Proportion = obs_36$Snap.Proportion,
ktPAon_log = log(obs_36$ktPAon),
KdtPAnoplg_log = log(obs_36$KdtPAnoplg),
kplgon_log = log(obs_36$kplgon)
)
predicted_reciprocal <- predict(best_model, newdata = new_data)
predicted_medianlysis <- 1 / predicted_reciprocal
cat("Actual:", obs_36$medianlysis, "\n")
cat("Predicted:", predicted_medianlysis, "\n")
cat("Error:", abs(obs_36$medianlysis - predicted_medianlysis), "\n")
# Read data and prepare transformed dataset
lysis <- read.csv("target.csv")
lysis$ktPAon_log <- log(lysis$ktPAon)
lysis$kplioff_log <- log(lysis$kplioff)
lysis$kplgon_log <- log(lysis$kplgon)
lysis$KdtPAnoplg_log <- log(lysis$KdtPAnoplg)
lysis$kdeg_kncat_log <- log(lysis$kdeg.and.kncat)
lysis_trans <- data.frame(
Snap.Proportion = lysis$Snap.Proportion,
ktPAon_log = lysis$ktPAon_log,
kplioff_log = lysis$kplioff_log,
kplgon_log = lysis$kplgon_log,
KdtPAnoplg_log = lysis$KdtPAnoplg_log,
kdeg_kncat_log = lysis$kdeg_kncat_log,
medianlysis = 1/lysis$medianlysis
)
# Rebuild the model
best_model <- lm(medianlysis ~ kdeg_kncat_log + kplioff_log + Snap.Proportion +
ktPAon_log + KdtPAnoplg_log + kplgon_log, data = lysis_trans)
# High leverage observations: 5, 14, 17, 22, 25, 34, 37, 38, 42
high_leverage <- c(5, 14, 17, 22, 25, 34, 37, 38, 42)
# Pick observation 1 (NOT in high leverage list)
obs_idx <- 1
obs_1 <- lysis[obs_idx, ]
cat("=== OBSERVATION", obs_idx, "PREDICTION ===\n\n")
cat("Original Values:\n")
cat("Snap.Proportion:", obs_1$Snap.Proportion, "\n")
cat("ktPAon:", obs_1$ktPAon, "\n")
cat("kplioff:", obs_1$kplioff, "\n")
cat("kplgon:", obs_1$kplgon, "\n")
cat("KdtPAnoplg:", obs_1$KdtPAnoplg, "\n")
cat("kdeg.and.kncat:", obs_1$kdeg.and.kncat, "\n")
cat("Actual medianlysis:", obs_1$medianlysis, "\n\n")
# Prepare data for prediction
new_data <- data.frame(
kdeg_kncat_log = log(obs_1$kdeg.and.kncat),
kplioff_log = log(obs_1$kplioff),
Snap.Proportion = obs_1$Snap.Proportion,
ktPAon_log = log(obs_1$ktPAon),
KdtPAnoplg_log = log(obs_1$KdtPAnoplg),
kplgon_log = log(obs_1$kplgon)
)
# Predict
predicted_reciprocal <- predict(best_model, newdata = new_data)
predicted_medianlysis <- 1 / predicted_reciprocal
# Compare
cat("=== PREDICTION RESULTS ===\n")
cat("Actual medianlysis:    ", obs_1$medianlysis, "\n")
cat("Predicted medianlysis: ", predicted_medianlysis, "\n")
cat("Difference:            ", abs(obs_1$medianlysis - predicted_medianlysis), "\n")
cat("Percent Error:         ", abs(obs_1$medianlysis - predicted_medianlysis) / obs_1$medianlysis * 100, "%\n")
library(car)
library(MASS)
library(leaps)
library(psych)
library(corrplot)
lysis <- read.csv("target.csv")
summary(lysis)
sapply(lysis, sd)
describe(lysis)
pairs(lysis[, c("medianlysis", "Snap.Proportion", "ktPAon", "kplioff", "kplgon", "KdtPAyesplg", "KdtPAnoplg", "KdPLGnicked", "KdPLGintact", "kdeg.and.kncat")], lower.panel=NULL)
Org_model <- lm(medianlysis ~., data = lysis)
summary(Org_model)
cor(lysis)
corrplot(cor(lysis), method = "color", t1.cex=0.7)
par(mfrow=c(3,3))
for(i in 1:9) hist(lysis[[i]], main=names(lysis)[i])
hist(lysis$medianlysis, main="medianlysis")
# Snap.Proportion is a proportion (0–1), not a rate constant or concentration. It may already be bounded and less skewed, or have a different distribution, so log transformation is unnecessary.
lysis$ktPAon_log <- log(lysis$ktPAon)
lysis$kplioff_log <- log(lysis$kplioff)
lysis$kplgon_log <- log(lysis$kplgon)
lysis$KdtPAyesplg_log <- log(lysis$KdtPAyesplg)
lysis$KdtPAnoplg_log <- log(lysis$KdtPAnoplg)
lysis$KdPLGnicked_log <- log(lysis$KdPLGnicked)
lysis$KdPLGintact_log <- log(lysis$KdPLGintact)
lysis$kdeg_kncat_log <- log(lysis$kdeg.and.kncat)
# Keep transformed predictors + original Snap.Proportion
lysis_trans <- data.frame(
Snap.Proportion = lysis$Snap.Proportion,
ktPAon_log = lysis$ktPAon_log,
kplioff_log = lysis$kplioff_log,
kplgon_log = lysis$kplgon_log,
KdtPAyesplg_log = lysis$KdtPAyesplg_log,
KdtPAnoplg_log = lysis$KdtPAnoplg_log,
KdPLGnicked_log = lysis$KdPLGnicked_log,
KdPLGintact_log = lysis$KdPLGintact_log,
kdeg_kncat_log = lysis$kdeg_kncat_log,
medianlysis = lysis$medianlysis
)
# Quick check
summary(lysis_trans)
par(mfrow=c(3,3))
for(i in 1:9) hist(lysis_trans[[i]], main=names(lysis_trans)[i])
#Model Fitting
lysis_lm <- lm(medianlysis ~., data = lysis_trans)
summary(lysis_lm)
boxcox(lysis_lm)
lysis_trans$medianlysis <- 1/(lysis_trans$medianlysis) # this would push the inverse of medianlysis to medianlysis variable - the name remains unchanged but the transformation happens
# refitting the model with transformed data
trans_lysis_lm <- lm(medianlysis ~., data = lysis_trans)
summary(trans_lysis_lm)
# Checking for multi-collinearity
vif(trans_lysis_lm) # No multi-collinearity present all are less than 10 (cut-off)
fwd <- lm(medianlysis ~ 1, data = lysis_trans)
out_fwd <- step(fwd, scope = ~ Snap.Proportion + ktPAon_log + kplioff_log + kplgon_log + KdtPAyesplg_log + KdtPAnoplg_log +KdPLGnicked_log+ KdPLGintact_log+kdeg_kncat_log , direction = "forward")
summary(out_fwd)
subset_model <- regsubsets(medianlysis ~ kdeg_kncat_log + kplioff_log +
Snap.Proportion + ktPAon_log + KdtPAnoplg_log +
KdtPAyesplg_log + kplgon_log + KdPLGnicked_log +
KdPLGintact_log,
data = lysis_trans)
summary(subset_model)$outmat
names(summary(subset_model))
which.min(summary(subset_model)$bic)
which.max(summary(subset_model)$adjr2)
plot(subset_model, scale = "adjr2")
best_model <- lm(medianlysis ~ kdeg_kncat_log + kplioff_log +Snap.Proportion + ktPAon_log + KdtPAnoplg_log + kplgon_log, data = lysis_trans)
summary(best_model)
# Constant variance check
plot(best_model, 1)
# Normality check
plot(best_model, 2)
#Outlier check
rstd <- rstandard(best_model)
which(abs(rstd)>3)
# High Leverage
h <- hatvalues(best_model)
# cut-off value would be: (2(k+1))/n = (2*(6+1))/42 = 14/42 = 0.3333
which(h > 0.3333)
# influential Observations
ckd <- cooks.distance(best_model)
which(ckd > 0.5)
which(ckd > 1)
plot(best_model, 5)
# Observation 20 values from the CSV:
# Snap.Proportion: 0.6667
# ktPAon: 0.1
# kplioff: 57.6
# kplgon: 0.1
# KdtPAnoplg: 0.36
# kdeg.and.kncat: 5
# Actual medianlysis: 0.5276
# Create data frame with log-transformed values
new_data <- data.frame(
kdeg_kncat_log = log(5),
kplioff_log = log(57.6),
Snap.Proportion = 0.6667,
ktPAon_log = log(0.1),
KdtPAnoplg_log = log(0.36),
kplgon_log = log(0.1)
)
# Predict using best_model
predicted_reciprocal <- predict(best_model, newdata = new_data)
# Transform back to medianlysis
predicted_medianlysis <- 1 / predicted_reciprocal
# Print output
cat("Predicted medianlysis:", predicted_medianlysis, "\n")
cat("Actual medianlysis: 0.5276\n")
cat("Difference:", abs(0.5276 - predicted_medianlysis), "\n")
# A Good Prediction that fills hope
# Observation 20 values from the CSV:
# Snap.Proportion: 0.6667
# ktPAon: 0.1
# kplioff: 57.6
# kplgon: 0.1
# KdtPAnoplg: 0.36
# kdeg.and.kncat: 5
# Actual medianlysis: 0.5276
new_data <- data.frame(
kdeg_kncat_log = log(5),
kplioff_log = log(57.6),
Snap.Proportion = 0.6667,
ktPAon_log = log(0.1),
KdtPAnoplg_log = log(0.36),
kplgon_log = log(0.1)
)
predicted_reciprocal<- predict(best_model, newdata = new_data)
predicted_medianlysis<- 1 / predicted_reciprocal
cat("Predicted medianlysis:", predicted_medianlysis, "\n")
cat("Actual medianlysis: 0.5276\n")
cat("Difference:", abs(0.5276- predicted_medianlysis), "\n")
0.5537 - 0.5276
# A bad prediction that destroys Confidence
# Observation 25 values from the CSV:
# Snap.Proportion: 0.6667
# ktPAon: 0.1
# kplioff: 57.6
# kplgon: 0.1
# KdtPAnoplg: 0.036
# kdeg.and.kncat: 5
# Actual medianlysis: 1.606
new_data <- data.frame(
kdeg_kncat_log = log(5),
kplioff_log = log(57.6),
Snap.Proportion = 0.6667,
ktPAon_log = log(0.1),
KdtPAnoplg_log = log(0.036),
kplgon_log = log(0.1)
)
predicted_reciprocal<- predict(best_model, newdata = new_data)
predicted_medianlysis<- 1 / predicted_reciprocal
cat("Predicted medianlysis:", predicted_medianlysis, "\n")
cat("Actual medianlysis: 1.606\n")
cat("Difference:", abs(1.606- predicted_medianlysis), "\n")
